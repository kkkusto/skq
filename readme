import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Example data
data = {
    "Activity Name": ["Task A", "Task B", "Task C", "Task D", "Task E"],
    "Run Start": ["2025-01-22 08:00", "2025-01-22 09:30", "2025-01-22 11:00", "2025-01-22 12:00", "2025-01-22 14:00"],
    "End Time": ["2025-01-22 09:00", "2025-01-22 10:30", "2025-01-22 12:30", "2025-01-22 13:30", "2025-01-22 15:00"],
}

# Convert to DataFrame
df = pd.DataFrame(data)
df["Run Start"] = pd.to_datetime(df["Run Start"])
df["End Time"] = pd.to_datetime(df["End Time"])
df["Duration (mins)"] = (df["End Time"] - df["Run Start"]).dt.total_seconds() / 60

# Plot Gantt chart
plt.figure(figsize=(10, 6))
sns.set(style="whitegrid")

# Create a bar plot
sns.barplot(
    x="Duration (mins)",
    y="Activity Name",
    data=df,
    hue="Activity Name",
    dodge=False,
    palette="viridis",
    orient="h"
)

# Customize the plot
plt.title("Gantt Chart of Activities")
plt.xlabel("Duration (Minutes)")
plt.ylabel("Activity Name")
plt.legend(title="Activity Name", bbox_to_anchor=(1.05, 1), loc="upper left")

# Enable scrollable x-axis
plt.gca().set_xlim(left=0, right=df["Duration (mins)"].max() + 10)
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()
