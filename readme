SELECT 
    r.request_id,
    r.status AS query_status,
    r.sql_text,
    r.total_elapsed_time AS query_time_ms,
    s.user_name,
    s.session_id,
    w.wait_type,
    w.wait_duration_ms
FROM sys.dm_pdw_exec_requests r
LEFT JOIN sys.dm_pdw_exec_sessions s ON r.session_id = s.session_id
LEFT JOIN sys.dm_pdw_waits w ON r.request_id = w.request_id
WHERE r.status IN ('Running', 'Suspended', 'Completed')
ORDER BY r.submit_time DESC;


SELECT 
    r.request_id,
    r.sql_text,
    r.status AS query_status,
    r.total_elapsed_time AS query_duration,
    s.user_name,
    s.session_id,
    w.wait_type,
    w.wait_duration_ms
FROM sys.dm_pdw_exec_requests r
LEFT JOIN sys.dm_pdw_exec_sessions s ON r.session_id = s.session_id
LEFT JOIN sys.dm_pdw_waits w ON r.request_id = w.request_id
WHERE r.status IN ('Running', 'Completed')
ORDER BY r.submit_time DESC;
